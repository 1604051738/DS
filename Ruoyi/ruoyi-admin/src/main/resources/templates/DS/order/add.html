<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org" >
<head>
    <th:block th:include="include :: header('新增销售订单')" />
    <th:block th:include="include :: datetimepicker-css" />
</head>
<body class="white-bg">
    <div class="wrapper wrapper-content animated fadeInRight ibox-content">
        <form class="form-horizontal m" id="form-order-add">
            <div class="form-group">    
                <label class="col-sm-3 control-label">原订单id：</label>
                <div class="col-sm-8">
                    <input name="saleIdO" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label"><span style="color: red; ">*</span>总金额：</label>
                <div class="col-sm-8">
                    <input name="totalCost" class="form-control" type="text" required>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">总采购货本：</label>
                <div class="col-sm-8">
                    <input name="totalPurchase" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">预计运费：</label>
                <div class="col-sm-8">
                    <input name="exceptFreight" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">货代运费：</label>
                <div class="col-sm-8">
                    <input name="forwarderFreight" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label"><span style="color: red; ">*</span>收货地址：</label>
                <div class="col-sm-8">
                    <input name="address" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label">买家ID：</label>
                <div class="col-sm-8">
                    <select name="customId" id="client" class="form-control" type="text">
                        <option value="">-----</option>
                    </select>
                </div>
                <a class="btn btn-primary" onclick="layerOpenClient()" ><i class="fa fa-plus"></i>买家</a>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">物流跟踪号：</label>
                <div class="col-sm-8">
                    <input name="salesOrdercol" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">外部物流订单ID：</label>
                <div class="col-sm-8">
                    <input name="salesOrdercolE" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">出库重量：</label>
                <div class="col-sm-8">
                    <input name="outboundWeight" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">数量类型：</label>
                <div class="col-sm-8">
                    <select name="numberType" class="form-control m-b">
                        <option value="1">单SKU单数量</option>
                        <option value="2">单SKU多数量</option>
                        <option value="3">多SKU</option>
                    </select>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label"><span style="color: red; ">*</span>是否退款：</label>
                <div class="col-sm-8">
                    <select name="isRefunded" class="form-control m-b" required>
                        <option value="0" selected>未退款订单</option>
                        <option value="1">退款订单</option>
                    </select>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">退款时间：</label>
                <div class="col-sm-8">
                    <div class="input-group date">
                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        <input type="text" class="time-input"   name="refundedTime" data-format="yyyy-MM-dd HH:mm:ss"/>
                    </div>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">退款原因：</label>
                <div class="col-sm-8">
                    <textarea name="refundedReason" class="form-control" rows="5s"></textarea>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-3 control-label">备注给用户：</label>
                <div class="col-sm-8">
                    <textarea name="remarkToCustom" class="form-control" rows="5s"></textarea>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">发货仓库：</label>
                <div class="col-sm-8">
                    <select name="warehouse" id="warehouse" class="form-control m-b">
                    </select>
                    <a class="btn btn-primary" onclick="layerOpenWareahouse()" ><i class="fa fa-plus"></i>仓库</a>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">货代重量：</label>
                <div class="col-sm-8">
                    <input name="forwarderWeight" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">转单号：</label>
                <div class="col-sm-8">
                    <input name="newOdd" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">物流渠道：</label>
                <div class="col-sm-8">
                    <select name="logisticsChannel"  id="logisticsChannel" class="form-control m-b">
                    </select>
                </div>
                <a class="btn btn-primary" onclick="layerOpenLogistics()" ><i class="fa fa-plus"></i>物流渠道</a>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">退款金额：</label>
                <div class="col-sm-8">
                    <input name="refunded amount" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">总重：</label>
                <div class="col-sm-8">
                    <input name="totalWeight" class="form-control" type="text">
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label"><span style="color: red; ">*</span>订单状态：</label>
                <div class="col-sm-8">
                    <select name="orderStatus" class="form-control m-b" required>
                        <option value="1" selected>待处理</option>
                        <option value="2">待打印</option>
                        <option value="3">已包装</option>
                        <option value="4">已出库</option>
                        <option value="5">暂停处理</option>
                        <option value="6">已退回</option>
                        <option value="7">已审核</option>
                        <option value="0">已取消</option>
                    </select>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label"><span style="color: red; ">*</span>付款状态：</label>
                <div class="col-sm-8">
                    <select name="payStatus" class="form-control m-b" required>
                        <option value="0" selected>未付款</option>
                        <option value="1">已付款</option>
                        <option value="2">部分付款</option>
                    </select>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label"><span style="color: red; ">*</span>物流跟踪状态：</label>
                <div class="col-sm-8">
                    <select name="logisticsStatus" class="form-control m-b" required>
                        <option value="0" selected>未知</option>
                        <option value="1">货代已收货</option>
                        <option value="2">邮局已收货</option>
                    </select>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label"><span style="color: red; ">*</span>是否为换货订单：</label>
                <div class="col-sm-8">
                    <select name="isExchange" class="form-control m-b" required>
                        <option value="0" selected>否</option>
                        <option value="1">是</option>
                    </select>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">出库时间：</label>
                <div class="col-sm-8">
                    <div class="input-group date">
                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        <input type="text" class="time-input"   name="storageTime" data-format="yyyy-MM-dd HH:mm:ss"/>
                    </div>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">标记发货时间：</label>
                <div class="col-sm-8">
                    <div class="input-group date">
                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        <input type="text" class="time-input"   name="deliverRemarkTime" data-format="yyyy-MM-dd HH:mm:ss"/>
                    </div>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">物流方接单时间：</label>
                <div class="col-sm-8">
                    <div class="input-group date">
                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        <input type="text" class="time-input"   name="logisticsAcceptTime" data-format="yyyy-MM-dd HH:mm:ss"/>
                    </div>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">下载时间：</label>
                <div class="col-sm-8">
                    <div class="input-group date">
                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        <input type="text" class="time-input"  name="dowloadTime" data-format="yyyy-MM-dd HH:mm:ss"/>
                    </div>
                </div>
            </div>
            <div class="form-group">    
                <label class="col-sm-3 control-label">客户购买时间：</label>
                <div class="col-sm-8">
                    <div class="input-group date">
                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                        <input type="text" class="time-input"   name="customBuyTime" data-format="yyyy-MM-dd HH:mm:ss"/>
                    </div>
                </div>
            </div>
        </form>


    </div>
    <div class="btn-group clearfix show-xs save-group col-xs-12" style="position: fixed; margin-left: -10px; right: 10px;  bottom: 10px; width: 20% ">
        <div class="col-sm-offset-5 col-sm-10">
            <button type="button" class="default btn btn-primary hide-xs" onclick="submitHandler()"><i class="fa fa-check"></i>保 存</button>&nbsp;
            <button type="button" class="btn btn-default" onclick="closeItem()"><i class="fa fa-reply-all"></i>关 闭 </button>
        </div>
    </div>
    <th:block th:include="include :: footer" />
    <th:block th:include="include :: datetimepicker-js" />
    <script type="text/javascript">
        $().ready(function () {
                $("#client").one("click", refresh());
            }
        )



        var prefix = ctx + "DS/order"
        $("#form-order-add").validate({
            focusCleanup: true
        });

        function submitHandler() {
            if ($.validate.form()) {
                $.operate.save(prefix + "/add", $('#form-order-add').serialize(),function(result) {
                    if(self.frameElement.tagName=="IFRAME" && typeof (window.parent.refresh) == "function"){
                        // 在frame中时处理
                        $.operate.successCallback(result);
                    }
                    $.operate.successTabCallback(result);
                });
            }
        }

        /*
       layer.open打开第三方添加界面
       */
        function layerOpenWareahouse() {
            layer.open({
                    type: 2,
                    title: "添加仓库",
                    content: "/DS/warehouse/add",
                    area: ['80%','80%']
                }
            )
        }

        /*
      layer.open打开第三方添加界面
      */
        function layerOpenLogistics() {
            layer.open({
                    type: 2,
                    title: "添加物流渠道",
                    content: "/DS/channel/add",
                    area: ['80%','80%']
                }
            )
        }


        /*
            ajax 获取select列表
        */
        function refresh() {
            $("#warehouse").empty();
            // $("#client").empty();
            $("#warehouse").append("<option value=\"\">-----</option>");
            // $("#client").append("<option value=\"\">-----</option>");
            $("#logisticsChannel").empty();
            $("#logisticsChannel").append("<option value=\"\">-----</option>");
            // $.get(prefix + "/refreshClient",function (result) {
            //     $.each(result,function (i, name) {
            //         $("#client").append("<option value="+i+">"+name+"</option>");
            //     })
            // });

            $.get(prefix + "/refreshWareHouse",function (result) {
                $.each(result,function (i, name) {
                    $("#warehouse").append("<option value="+i+">"+i+":"+name+"</option>");
                })
            });

            $.get(prefix + "/refreshChannel",function (result) {
                $.each(result,function (i, name) {
                    $("#logisticsChannel").append("<option value="+i+">"+i+":"+name+"</option>");
                })
            });
        }

       //  /*
       // layer.open打开第三方添加界面
       // */
       //  function layerOpenClient() {
       //      layer.open({
       //              type: 2,
       //              title: "添加收货人",
       //              content: "/DS/client/add",
       //              area: ['80%','80%']
       //          }
       //      )
       //  }


        /*
      layer.open打开第三方添加界面
      */
        function layerOpenWareahouse() {
            layer.open({
                    type: 2,
                    title: "添加物流渠道",
                    content: "/DS/channel/add",
                    area: ['80%','80%']
                }
            )
        }



        $("input[name='refundedTime']").datetimepicker({
            format: 'yyyy-mm-dd hh:ii:ss',
            autoclose: true,
            minView: 0,
            minuteStep:1
        });

        $("input[name='storageTime']").datetimepicker({
            format: 'yyyy-mm-dd hh:ii:ss',
            autoclose: true,
            minView: 0,
            minuteStep:1
        });

        $("input[name='deliverRemarkTime']").datetimepicker({
            format: 'yyyy-mm-dd hh:ii:ss',
            autoclose: true,
            minView: 0,
            minuteStep:1
        });

        $("input[name='logisticsAcceptTime']").datetimepicker({
            format: 'yyyy-mm-dd hh:ii:ss',
            autoclose: true,
            minView: 0,
            minuteStep:1
        });

        $("input[name='dowloadTime']").datetimepicker({
            format: 'yyyy-mm-dd hh:ii:ss',
            autoclose: true,
            minView: 0,
            minuteStep:1
        });

        $("input[name='customBuyTime']").datetimepicker({
            format: 'yyyy-mm-dd hh:ii:ss',
            autoclose: true,
            minView: 0,
            minuteStep:1
        });
    </script>
</body>
</html>